
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="..">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.8">
    
    
      
        <title>Analysis - JEM207 - Final project</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.f2e4d321.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="teal">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#analysis" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="JEM207 - Final project" class="md-header__button md-logo" aria-label="JEM207 - Final project" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            JEM207 - Final project
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Analysis
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="teal"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="teal"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Project specification

      </a>
    </li>
  

      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
    
  
  Analysis

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="JEM207 - Final project" class="md-nav__button md-logo" aria-label="JEM207 - Final project" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    JEM207 - Final project
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Project specification
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Analysis
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Analysis
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#importing-the-dataset" class="md-nav__link">
    <span class="md-ellipsis">
      Importing the dataset:
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pre-setting-and-handling-missing-data" class="md-nav__link">
    <span class="md-ellipsis">
      Pre-setting and handling missing data:
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#descriptive-statistics-and-variability-across-groups" class="md-nav__link">
    <span class="md-ellipsis">
      Descriptive statistics and variability across groups
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-testing-and-comparing-models" class="md-nav__link">
    <span class="md-ellipsis">
      Running, testing, and comparing models.
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#result" class="md-nav__link">
    <span class="md-ellipsis">
      Result
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="analysis">Analysis<a class="headerlink" href="#analysis" title="Permanent link">&para;</a></h1>
<p>The next steps constitude the treatment and analysis of the data. Additionally, the establishment of the best model.</p>
<h2 id="importing-the-dataset">Importing the dataset:<a class="headerlink" href="#importing-the-dataset" title="Permanent link">&para;</a></h2>
<p>For this we use the deafult method for importing data from UCI repository.</p>
<p><div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Importing UCI dataset</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="kn">from</span> <span class="nn">ucimlrepo</span> <span class="kn">import</span> <span class="n">fetch_ucirepo</span> 
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="c1"># fetch dataset </span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="n">heart_disease</span> <span class="o">=</span> <span class="n">fetch_ucirepo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span> 
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="c1"># data (as pandas dataframes) </span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="hll"><span class="n">features</span> <span class="o">=</span> <span class="n">heart_disease</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">features</span> 
</span><a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="hll"><span class="n">targets</span> <span class="o">=</span> <span class="n">heart_disease</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">targets</span> 
</span><a id="__codelineno-0-9" name="__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="c1"># metadata </span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="nb">print</span><span class="p">(</span><span class="n">heart_disease</span><span class="o">.</span><span class="n">metadata</span><span class="p">)</span> 
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="c1"># variable information </span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="nb">print</span><span class="p">(</span><span class="n">heart_disease</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span> 
</code></pre></div></td></tr></table></div>
By default, the data correspond to a sample of adults from Cleveland. It is constituted by 303 observations, 13 explanatory variables, and 1 multicategorical target variable.</p>
<h2 id="pre-setting-and-handling-missing-data">Pre-setting and handling missing data:<a class="headerlink" href="#pre-setting-and-handling-missing-data" title="Permanent link">&para;</a></h2>
<p>After exploring a bit the dataset and determining the existence of missing data we opt to do two processes. The first one was the assign the correct data types according to the values of each attribute, and the second imputing and dropping rows with missing data.</p>
<p><div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Assigning correct data types</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span>
<span class="normal"><a href="#__codelineno-1-2">2</a></span>
<span class="normal"><a href="#__codelineno-1-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="c1">#Setting of correct data types</span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="n">base_df</span> <span class="o">=</span> <span class="n">base_df</span><span class="o">.</span><span class="n">astype</span><span class="p">({</span><span class="s2">&quot;sex&quot;</span><span class="p">:</span> <span class="s2">&quot;category&quot;</span><span class="p">,</span> <span class="s2">&quot;cp&quot;</span><span class="p">:</span> <span class="s2">&quot;category&quot;</span><span class="p">,</span> <span class="s2">&quot;fbs&quot;</span><span class="p">:</span> <span class="s2">&quot;category&quot;</span><span class="p">,</span> <span class="s2">&quot;restecg&quot;</span><span class="p">:</span> <span class="s2">&quot;category&quot;</span><span class="p">,</span>
<a id="__codelineno-1-3" name="__codelineno-1-3"></a>               <span class="s2">&quot;exang&quot;</span><span class="p">:</span> <span class="s2">&quot;category&quot;</span><span class="p">,</span> <span class="s2">&quot;slope&quot;</span><span class="p">:</span> <span class="s2">&quot;category&quot;</span><span class="p">,</span> <span class="s2">&quot;thal&quot;</span><span class="p">:</span> <span class="s2">&quot;category&quot;</span><span class="p">,</span> <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;category&quot;</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<b>Handling missing data</b></p>
<ul>
<li>For numeric data we decided to imputate the mean in order to keep the consistency of the data and not loose those registers.</li>
<li>Fur categorical data, in order to avoid possible bias, we decided to drop the two registers that were NAs taking into account that putting an arbitrary value there could alter our analysis.</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Handling missing data</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1">1</a></span>
<span class="normal"><a href="#__codelineno-2-2">2</a></span>
<span class="normal"><a href="#__codelineno-2-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="c1">#Imputation and dropping</span>
<a id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="n">df</span><span class="p">[</span><span class="s2">&quot;ca&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;ca&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;ca&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="c1">#Filling with the mean </span>
<a id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s2">&quot;any&quot;</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1">#Dropping qualitative missing data</span>
</code></pre></div></td></tr></table></div>
<h2 id="descriptive-statistics-and-variability-across-groups">Descriptive statistics and variability across groups<a class="headerlink" href="#descriptive-statistics-and-variability-across-groups" title="Permanent link">&para;</a></h2>
<p>Before running our models we decided to calculate some descriptive statistics and variability test across groups to be sure that our findings were not biased by inconsistencies. For our descriptive statistics we found an approximate normal behaviour across variables. Additionally, we tested if there was a behavioural difference between men and women, and below and above the threshold of 65 (age in which an increase in cardiovascular attacks is expected).</p>
<p>Finally, we conclude this section by running a correlation matrix to understand if there was a risk of collinearity that we should handle before running our models.</p>
<h2 id="running-testing-and-comparing-models">Running, testing, and comparing models.<a class="headerlink" href="#running-testing-and-comparing-models" title="Permanent link">&para;</a></h2>
<p>To sum up, we create a function that allowed us to compare with the same sample and target variables the fit and performance of 5 models:
* Regression: Linear discriminant model, logistic regression, and probit regression.
* Classification trees: Random forest.
* Generalized linear classifiers: Supported Vector Machine.</p>
<p>This function also covered the topics of training and testing, cross validation, one-hot encoding, and scaling.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Creating and comparing models</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">  1</a></span>
<span class="normal"><a href="#__codelineno-3-2">  2</a></span>
<span class="normal"><a href="#__codelineno-3-3">  3</a></span>
<span class="normal"><a href="#__codelineno-3-4">  4</a></span>
<span class="normal"><a href="#__codelineno-3-5">  5</a></span>
<span class="normal"><a href="#__codelineno-3-6">  6</a></span>
<span class="normal"><a href="#__codelineno-3-7">  7</a></span>
<span class="normal"><a href="#__codelineno-3-8">  8</a></span>
<span class="normal"><a href="#__codelineno-3-9">  9</a></span>
<span class="normal"><a href="#__codelineno-3-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-3-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-3-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-3-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-3-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-3-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-3-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-3-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-3-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-3-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-3-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-3-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-3-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-3-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-3-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-3-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-3-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-3-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-3-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-3-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-3-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-3-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-3-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-3-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-3-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-3-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-3-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-3-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-3-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-3-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-3-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-3-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-3-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-3-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-3-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-3-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-3-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-3-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-3-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-3-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-3-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-3-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-3-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-3-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-3-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-3-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-3-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-3-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-3-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-3-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-3-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-3-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-3-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-3-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-3-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-3-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-3-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-3-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-3-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-3-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-3-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-3-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-3-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-3-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-3-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-3-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-3-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-3-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-3-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-3-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-3-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-3-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-3-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-3-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-3-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-3-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-3-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-3-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-3-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-3-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-3-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-3-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-3-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-3-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-3-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-3-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-3-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-3-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-3-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-3-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-3-100">100</a></span>
<span class="normal"><a href="#__codelineno-3-101">101</a></span>
<span class="normal"><a href="#__codelineno-3-102">102</a></span>
<span class="normal"><a href="#__codelineno-3-103">103</a></span>
<span class="normal"><a href="#__codelineno-3-104">104</a></span>
<span class="normal"><a href="#__codelineno-3-105">105</a></span>
<span class="normal"><a href="#__codelineno-3-106">106</a></span>
<span class="normal"><a href="#__codelineno-3-107">107</a></span>
<span class="normal"><a href="#__codelineno-3-108">108</a></span>
<span class="normal"><a href="#__codelineno-3-109">109</a></span>
<span class="normal"><a href="#__codelineno-3-110">110</a></span>
<span class="normal"><a href="#__codelineno-3-111">111</a></span>
<span class="normal"><a href="#__codelineno-3-112">112</a></span>
<span class="normal"><a href="#__codelineno-3-113">113</a></span>
<span class="normal"><a href="#__codelineno-3-114">114</a></span>
<span class="normal"><a href="#__codelineno-3-115">115</a></span>
<span class="normal"><a href="#__codelineno-3-116">116</a></span>
<span class="normal"><a href="#__codelineno-3-117">117</a></span>
<span class="normal"><a href="#__codelineno-3-118">118</a></span>
<span class="normal"><a href="#__codelineno-3-119">119</a></span>
<span class="normal"><a href="#__codelineno-3-120">120</a></span>
<span class="normal"><a href="#__codelineno-3-121">121</a></span>
<span class="normal"><a href="#__codelineno-3-122">122</a></span>
<span class="normal"><a href="#__codelineno-3-123">123</a></span>
<span class="normal"><a href="#__codelineno-3-124">124</a></span>
<span class="normal"><a href="#__codelineno-3-125">125</a></span>
<span class="normal"><a href="#__codelineno-3-126">126</a></span>
<span class="normal"><a href="#__codelineno-3-127">127</a></span>
<span class="normal"><a href="#__codelineno-3-128">128</a></span>
<span class="normal"><a href="#__codelineno-3-129">129</a></span>
<span class="normal"><a href="#__codelineno-3-130">130</a></span>
<span class="normal"><a href="#__codelineno-3-131">131</a></span>
<span class="normal"><a href="#__codelineno-3-132">132</a></span>
<span class="normal"><a href="#__codelineno-3-133">133</a></span>
<span class="normal"><a href="#__codelineno-3-134">134</a></span>
<span class="normal"><a href="#__codelineno-3-135">135</a></span>
<span class="normal"><a href="#__codelineno-3-136">136</a></span>
<span class="normal"><a href="#__codelineno-3-137">137</a></span>
<span class="normal"><a href="#__codelineno-3-138">138</a></span>
<span class="normal"><a href="#__codelineno-3-139">139</a></span>
<span class="normal"><a href="#__codelineno-3-140">140</a></span>
<span class="normal"><a href="#__codelineno-3-141">141</a></span>
<span class="normal"><a href="#__codelineno-3-142">142</a></span>
<span class="normal"><a href="#__codelineno-3-143">143</a></span>
<span class="normal"><a href="#__codelineno-3-144">144</a></span>
<span class="normal"><a href="#__codelineno-3-145">145</a></span>
<span class="normal"><a href="#__codelineno-3-146">146</a></span>
<span class="normal"><a href="#__codelineno-3-147">147</a></span>
<span class="normal"><a href="#__codelineno-3-148">148</a></span>
<span class="normal"><a href="#__codelineno-3-149">149</a></span>
<span class="normal"><a href="#__codelineno-3-150">150</a></span>
<span class="normal"><a href="#__codelineno-3-151">151</a></span>
<span class="normal"><a href="#__codelineno-3-152">152</a></span>
<span class="normal"><a href="#__codelineno-3-153">153</a></span>
<span class="normal"><a href="#__codelineno-3-154">154</a></span>
<span class="normal"><a href="#__codelineno-3-155">155</a></span>
<span class="normal"><a href="#__codelineno-3-156">156</a></span>
<span class="normal"><a href="#__codelineno-3-157">157</a></span>
<span class="normal"><a href="#__codelineno-3-158">158</a></span>
<span class="normal"><a href="#__codelineno-3-159">159</a></span>
<span class="normal"><a href="#__codelineno-3-160">160</a></span>
<span class="normal"><a href="#__codelineno-3-161">161</a></span>
<span class="normal"><a href="#__codelineno-3-162">162</a></span>
<span class="normal"><a href="#__codelineno-3-163">163</a></span>
<span class="normal"><a href="#__codelineno-3-164">164</a></span>
<span class="normal"><a href="#__codelineno-3-165">165</a></span>
<span class="normal"><a href="#__codelineno-3-166">166</a></span>
<span class="normal"><a href="#__codelineno-3-167">167</a></span>
<span class="normal"><a href="#__codelineno-3-168">168</a></span>
<span class="normal"><a href="#__codelineno-3-169">169</a></span>
<span class="normal"><a href="#__codelineno-3-170">170</a></span>
<span class="normal"><a href="#__codelineno-3-171">171</a></span>
<span class="normal"><a href="#__codelineno-3-172">172</a></span>
<span class="normal"><a href="#__codelineno-3-173">173</a></span>
<span class="normal"><a href="#__codelineno-3-174">174</a></span>
<span class="normal"><a href="#__codelineno-3-175">175</a></span>
<span class="normal"><a href="#__codelineno-3-176">176</a></span>
<span class="normal"><a href="#__codelineno-3-177">177</a></span>
<span class="normal"><a href="#__codelineno-3-178">178</a></span>
<span class="normal"><a href="#__codelineno-3-179">179</a></span>
<span class="normal"><a href="#__codelineno-3-180">180</a></span>
<span class="normal"><a href="#__codelineno-3-181">181</a></span>
<span class="normal"><a href="#__codelineno-3-182">182</a></span>
<span class="normal"><a href="#__codelineno-3-183">183</a></span>
<span class="normal"><a href="#__codelineno-3-184">184</a></span>
<span class="normal"><a href="#__codelineno-3-185">185</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="c1">## Function</span>
<a id="__codelineno-3-2" name="__codelineno-3-2"></a>
<a id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="k">def</span> <span class="nf">ModelPerformance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
<a id="__codelineno-3-4" name="__codelineno-3-4"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-3-5" name="__codelineno-3-5"></a><span class="sd">    ModelPerformance() function gets the data frame and the response variable from the user </span>
<a id="__codelineno-3-6" name="__codelineno-3-6"></a><span class="sd">    and aims to fit the best model out of Linear Discriminant Model (ldm_model), Logistic Regression Model (log_model),</span>
<a id="__codelineno-3-7" name="__codelineno-3-7"></a><span class="sd">    Probit Regression Model (probit_model), Random Forest Model (rf_model) and Support Vector Machines Model (svm_model).</span>
<a id="__codelineno-3-8" name="__codelineno-3-8"></a><span class="sd">    First the function creates training and testing data of explanatory variables as well as the response with</span>
<a id="__codelineno-3-9" name="__codelineno-3-9"></a><span class="sd">    train_test_split() function where the test_size is twenty percent of the entire data frame.</span>
<a id="__codelineno-3-10" name="__codelineno-3-10"></a><span class="sd">    Using Pipeline(), the function normalizes the numeric explanatory variables with StandardScaler() while creating </span>
<a id="__codelineno-3-11" name="__codelineno-3-11"></a><span class="sd">    dummy variables with OneHotEncoder() for categorical variables. Then using kFold() technique data frame is splitted </span>
<a id="__codelineno-3-12" name="__codelineno-3-12"></a><span class="sd">    into five folds, therefore n_splits is 5. Pipeline() function then creates the models with the preprocesses and </span>
<a id="__codelineno-3-13" name="__codelineno-3-13"></a><span class="sd">    classifier as the each model.</span>
<a id="__codelineno-3-14" name="__codelineno-3-14"></a>
<a id="__codelineno-3-15" name="__codelineno-3-15"></a><span class="sd">    Later on, the training data is fit to all five models with .fit(). The function extracts  </span>
<a id="__codelineno-3-16" name="__codelineno-3-16"></a><span class="sd">    information that are Cross-Validation accuracy scores with cross_val_score() and have a prediction on test data with</span>
<a id="__codelineno-3-17" name="__codelineno-3-17"></a><span class="sd">    .predict(). From the test data the function extracts accuracy with accuracy_score() and using re precision, recall </span>
<a id="__codelineno-3-18" name="__codelineno-3-18"></a><span class="sd">    and F1-scores of each model from the classification_report(). The function first presents the the Cross-Validation </span>
<a id="__codelineno-3-19" name="__codelineno-3-19"></a><span class="sd">    accuracy scores cv_scores_(model name) and Cross-Validation standard deviations of all five models in two seperate </span>
<a id="__codelineno-3-20" name="__codelineno-3-20"></a><span class="sd">    bar charts plt.bar() from pyplot. From the Cross-Validation results we can interpret how is the accuracy and fluctions</span>
<a id="__codelineno-3-21" name="__codelineno-3-21"></a><span class="sd">    for the each model on training data and it can help us analyze an overfit in the results. There is also a data frame </span>
<a id="__codelineno-3-22" name="__codelineno-3-22"></a><span class="sd">    provided for the Cross-Validation results which is cv_scores. Using .predict() we can predict the outcome values for </span>
<a id="__codelineno-3-23" name="__codelineno-3-23"></a><span class="sd">    test data which are Y_pred_(model name).The function also provides us a radar chart from plotly to analyze which model</span>
<a id="__codelineno-3-24" name="__codelineno-3-24"></a><span class="sd">    is best suiting for the the data frame with four metrics that are  accuracy, precision, recall and F1-scores. From the </span>
<a id="__codelineno-3-25" name="__codelineno-3-25"></a><span class="sd">    radar chart using .add_trace() we can compare the four different aspects to pick the model for prediction. Finally, the</span>
<a id="__codelineno-3-26" name="__codelineno-3-26"></a><span class="sd">    function provides a data frame for these metrics of each model to visualize each result which is model_perf.</span>
<a id="__codelineno-3-27" name="__codelineno-3-27"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-3-28" name="__codelineno-3-28"></a>    <span class="c1"># Preprocessing</span>
<a id="__codelineno-3-29" name="__codelineno-3-29"></a>    <span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="n">response</span><span class="p">]]</span> 
<a id="__codelineno-3-30" name="__codelineno-3-30"></a>    <span class="n">Y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">response</span><span class="p">]</span>
<a id="__codelineno-3-31" name="__codelineno-3-31"></a>    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<a id="__codelineno-3-32" name="__codelineno-3-32"></a>
<a id="__codelineno-3-33" name="__codelineno-3-33"></a>    <span class="n">numeric_features</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span> <span class="o">==</span> <span class="s2">&quot;int64&quot;</span><span class="p">]</span>
<a id="__codelineno-3-34" name="__codelineno-3-34"></a>    <span class="n">categorical_features</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span> <span class="o">==</span> <span class="s2">&quot;category&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="n">response</span><span class="p">)]</span>
<a id="__codelineno-3-35" name="__codelineno-3-35"></a>
<a id="__codelineno-3-36" name="__codelineno-3-36"></a>    <span class="n">numeric_transformer</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">())])</span>
<a id="__codelineno-3-37" name="__codelineno-3-37"></a>    <span class="n">categorical_transformer</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;onehot&#39;</span><span class="p">,</span> <span class="n">OneHotEncoder</span><span class="p">())])</span>
<a id="__codelineno-3-38" name="__codelineno-3-38"></a>
<a id="__codelineno-3-39" name="__codelineno-3-39"></a>    <span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">(</span><span class="n">transformers</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;num&#39;</span><span class="p">,</span> <span class="n">numeric_transformer</span><span class="p">,</span> <span class="n">numeric_features</span><span class="p">),</span>
<a id="__codelineno-3-40" name="__codelineno-3-40"></a>                                               <span class="p">(</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="n">categorical_transformer</span><span class="p">,</span> <span class="n">categorical_features</span><span class="p">)])</span>
<a id="__codelineno-3-41" name="__codelineno-3-41"></a>
<a id="__codelineno-3-42" name="__codelineno-3-42"></a>    <span class="n">folds</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<a id="__codelineno-3-43" name="__codelineno-3-43"></a>
<a id="__codelineno-3-44" name="__codelineno-3-44"></a>    <span class="c1"># Linear Discriminant Model</span>
<a id="__codelineno-3-45" name="__codelineno-3-45"></a>    <span class="n">ldm_model</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;preprocessor&#39;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span> 
<a id="__codelineno-3-46" name="__codelineno-3-46"></a>                            <span class="p">(</span><span class="s1">&#39;classifier&#39;</span><span class="p">,</span> <span class="n">LinearDiscriminantAnalysis</span><span class="p">())])</span>
<a id="__codelineno-3-47" name="__codelineno-3-47"></a>    <span class="n">ldm_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
<a id="__codelineno-3-48" name="__codelineno-3-48"></a>    <span class="n">cv_scores_ldm</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">ldm_model</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">folds</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">)</span>
<a id="__codelineno-3-49" name="__codelineno-3-49"></a>    <span class="n">Y_pred_ldm</span> <span class="o">=</span> <span class="n">ldm_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<a id="__codelineno-3-50" name="__codelineno-3-50"></a>    <span class="n">accuracy_ldm</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span> <span class="n">Y_pred_ldm</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-3-51" name="__codelineno-3-51"></a>    <span class="n">report_ldm</span> <span class="o">=</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span> <span class="n">Y_pred_ldm</span><span class="p">)</span>
<a id="__codelineno-3-52" name="__codelineno-3-52"></a>    <span class="n">precision_ldm</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;weighted avg\s+([\d.]+)&#39;</span><span class="p">,</span> <span class="n">report_ldm</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-3-53" name="__codelineno-3-53"></a>    <span class="n">recall_ldm</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;weighted avg\s+([\d.]+)\s+([\d.]+)\s+([\d.]+)\s+([\d.]+)&#39;</span><span class="p">,</span> <span class="n">report_ldm</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a id="__codelineno-3-54" name="__codelineno-3-54"></a>    <span class="n">f1_score_ldm</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;weighted avg\s+([\d.]+)\s+([\d.]+)\s+([\d.]+)\s+([\d.]+)&#39;</span><span class="p">,</span> <span class="n">report_ldm</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a id="__codelineno-3-55" name="__codelineno-3-55"></a>
<a id="__codelineno-3-56" name="__codelineno-3-56"></a>    <span class="c1"># Logistic Regression Model</span>
<a id="__codelineno-3-57" name="__codelineno-3-57"></a>    <span class="n">log_model</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;preprocessor&#39;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span> 
<a id="__codelineno-3-58" name="__codelineno-3-58"></a>                            <span class="p">(</span><span class="s1">&#39;classifier&#39;</span><span class="p">,</span> <span class="n">LogisticRegression</span><span class="p">())])</span>
<a id="__codelineno-3-59" name="__codelineno-3-59"></a>
<a id="__codelineno-3-60" name="__codelineno-3-60"></a>    <span class="n">log_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
<a id="__codelineno-3-61" name="__codelineno-3-61"></a>    <span class="n">cv_scores_log</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">log_model</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">folds</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">)</span>
<a id="__codelineno-3-62" name="__codelineno-3-62"></a>    <span class="n">Y_pred_log</span> <span class="o">=</span> <span class="n">log_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<a id="__codelineno-3-63" name="__codelineno-3-63"></a>    <span class="n">accuracy_log</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span> <span class="n">Y_pred_log</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-3-64" name="__codelineno-3-64"></a>    <span class="n">report_log</span> <span class="o">=</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span> <span class="n">Y_pred_log</span><span class="p">)</span>
<a id="__codelineno-3-65" name="__codelineno-3-65"></a>    <span class="n">precision_log</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;weighted avg\s+([\d.]+)&#39;</span><span class="p">,</span> <span class="n">report_log</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-3-66" name="__codelineno-3-66"></a>    <span class="n">recall_log</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;weighted avg\s+([\d.]+)\s+([\d.]+)\s+([\d.]+)\s+([\d.]+)&#39;</span><span class="p">,</span> <span class="n">report_log</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a id="__codelineno-3-67" name="__codelineno-3-67"></a>    <span class="n">f1_score_log</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;weighted avg\s+([\d.]+)\s+([\d.]+)\s+([\d.]+)\s+([\d.]+)&#39;</span><span class="p">,</span> <span class="n">report_log</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a id="__codelineno-3-68" name="__codelineno-3-68"></a>
<a id="__codelineno-3-69" name="__codelineno-3-69"></a>    <span class="c1"># Probit Regression Model</span>
<a id="__codelineno-3-70" name="__codelineno-3-70"></a>    <span class="n">probit_model</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;preprocessor&#39;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span> 
<a id="__codelineno-3-71" name="__codelineno-3-71"></a>                                <span class="p">(</span><span class="s1">&#39;classifier&#39;</span><span class="p">,</span>  <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;lbfgs&#39;</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">13</span><span class="p">))])</span>
<a id="__codelineno-3-72" name="__codelineno-3-72"></a>    <span class="n">probit_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
<a id="__codelineno-3-73" name="__codelineno-3-73"></a>    <span class="n">cv_scores_probit</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">probit_model</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">folds</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">)</span>
<a id="__codelineno-3-74" name="__codelineno-3-74"></a>    <span class="n">Y_pred_probit</span> <span class="o">=</span> <span class="n">probit_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<a id="__codelineno-3-75" name="__codelineno-3-75"></a>    <span class="n">accuracy_probit</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span> <span class="n">Y_pred_probit</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-3-76" name="__codelineno-3-76"></a>    <span class="n">report_probit</span> <span class="o">=</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span> <span class="n">Y_pred_probit</span><span class="p">)</span>
<a id="__codelineno-3-77" name="__codelineno-3-77"></a>    <span class="n">precision_probit</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;weighted avg\s+([\d.]+)&#39;</span><span class="p">,</span> <span class="n">report_probit</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-3-78" name="__codelineno-3-78"></a>    <span class="n">recall_probit</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;weighted avg\s+([\d.]+)\s+([\d.]+)\s+([\d.]+)\s+([\d.]+)&#39;</span><span class="p">,</span> <span class="n">report_probit</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a id="__codelineno-3-79" name="__codelineno-3-79"></a>    <span class="n">f1_score_probit</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;weighted avg\s+([\d.]+)\s+([\d.]+)\s+([\d.]+)\s+([\d.]+)&#39;</span><span class="p">,</span> <span class="n">report_probit</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a id="__codelineno-3-80" name="__codelineno-3-80"></a>
<a id="__codelineno-3-81" name="__codelineno-3-81"></a>
<a id="__codelineno-3-82" name="__codelineno-3-82"></a>    <span class="c1"># Random Forest Model</span>
<a id="__codelineno-3-83" name="__codelineno-3-83"></a>    <span class="n">rf_model</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;preprocessor&#39;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
<a id="__codelineno-3-84" name="__codelineno-3-84"></a>                               <span class="p">(</span><span class="s1">&#39;classifier&#39;</span><span class="p">,</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">13</span><span class="p">))])</span>
<a id="__codelineno-3-85" name="__codelineno-3-85"></a>    <span class="n">rf_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
<a id="__codelineno-3-86" name="__codelineno-3-86"></a>    <span class="n">cv_scores_rf</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">rf_model</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">folds</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">)</span>
<a id="__codelineno-3-87" name="__codelineno-3-87"></a>    <span class="n">Y_pred_rf</span> <span class="o">=</span> <span class="n">rf_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>  
<a id="__codelineno-3-88" name="__codelineno-3-88"></a>    <span class="n">accuracy_rf</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span> <span class="n">Y_pred_rf</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-3-89" name="__codelineno-3-89"></a>    <span class="n">report_rf</span> <span class="o">=</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span> <span class="n">Y_pred_rf</span><span class="p">)</span>
<a id="__codelineno-3-90" name="__codelineno-3-90"></a>    <span class="n">precision_rf</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;weighted avg\s+([\d.]+)&#39;</span><span class="p">,</span> <span class="n">report_rf</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-3-91" name="__codelineno-3-91"></a>    <span class="n">recall_rf</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;weighted avg\s+([\d.]+)\s+([\d.]+)\s+([\d.]+)\s+([\d.]+)&#39;</span><span class="p">,</span> <span class="n">report_rf</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a id="__codelineno-3-92" name="__codelineno-3-92"></a>    <span class="n">f1_score_rf</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;weighted avg\s+([\d.]+)\s+([\d.]+)\s+([\d.]+)\s+([\d.]+)&#39;</span><span class="p">,</span> <span class="n">report_rf</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a id="__codelineno-3-93" name="__codelineno-3-93"></a>
<a id="__codelineno-3-94" name="__codelineno-3-94"></a>    <span class="c1"># Supported Vector Machine Model</span>
<a id="__codelineno-3-95" name="__codelineno-3-95"></a>    <span class="n">svm_model</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;preprocessor&#39;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
<a id="__codelineno-3-96" name="__codelineno-3-96"></a>                            <span class="p">(</span><span class="s1">&#39;classifier&#39;</span><span class="p">,</span> <span class="n">SVC</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">13</span><span class="p">))])</span>
<a id="__codelineno-3-97" name="__codelineno-3-97"></a>    <span class="n">svm_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
<a id="__codelineno-3-98" name="__codelineno-3-98"></a>    <span class="n">cv_scores_svm</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">svm_model</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">folds</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">)</span>
<a id="__codelineno-3-99" name="__codelineno-3-99"></a>    <span class="n">Y_pred_svm</span> <span class="o">=</span> <span class="n">svm_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<a id="__codelineno-3-100" name="__codelineno-3-100"></a>    <span class="n">accuracy_svm</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span> <span class="n">Y_pred_svm</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-3-101" name="__codelineno-3-101"></a>    <span class="n">report_svm</span> <span class="o">=</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span> <span class="n">Y_pred_svm</span><span class="p">,</span> <span class="n">zero_division</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-3-102" name="__codelineno-3-102"></a>    <span class="n">precision_svm</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;weighted avg\s+([\d.]+)&#39;</span><span class="p">,</span> <span class="n">report_svm</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-3-103" name="__codelineno-3-103"></a>    <span class="n">recall_svm</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;weighted avg\s+([\d.]+)\s+([\d.]+)\s+([\d.]+)\s+([\d.]+)&#39;</span><span class="p">,</span> <span class="n">report_svm</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a id="__codelineno-3-104" name="__codelineno-3-104"></a>    <span class="n">f1_score_svm</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;weighted avg\s+([\d.]+)\s+([\d.]+)\s+([\d.]+)\s+([\d.]+)&#39;</span><span class="p">,</span> <span class="n">report_svm</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a id="__codelineno-3-105" name="__codelineno-3-105"></a>
<a id="__codelineno-3-106" name="__codelineno-3-106"></a>    <span class="c1"># Cross Validation mean score and standard deviation results</span>
<a id="__codelineno-3-107" name="__codelineno-3-107"></a>
<a id="__codelineno-3-108" name="__codelineno-3-108"></a>    <span class="n">cv_scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;CV Mean Score&quot;</span><span class="p">:[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cv_scores_ldm</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cv_scores_log</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cv_scores_probit</span><span class="p">),</span>
<a id="__codelineno-3-109" name="__codelineno-3-109"></a>                                               <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cv_scores_rf</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cv_scores_svm</span><span class="p">)],</span>
<a id="__codelineno-3-110" name="__codelineno-3-110"></a>                             <span class="s2">&quot;CV Standard Deviation&quot;</span><span class="p">:[</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">cv_scores_ldm</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">cv_scores_log</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">cv_scores_probit</span><span class="p">),</span>
<a id="__codelineno-3-111" name="__codelineno-3-111"></a>                                                 <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">cv_scores_rf</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">cv_scores_svm</span><span class="p">)]})</span>
<a id="__codelineno-3-112" name="__codelineno-3-112"></a>    <span class="n">cv_scores</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;LDM&quot;</span><span class="p">,</span><span class="s2">&quot;LOG&quot;</span><span class="p">,</span><span class="s2">&quot;PRO&quot;</span><span class="p">,</span><span class="s2">&quot;RF&quot;</span><span class="p">,</span><span class="s2">&quot;SVM&quot;</span><span class="p">]</span>
<a id="__codelineno-3-113" name="__codelineno-3-113"></a>
<a id="__codelineno-3-114" name="__codelineno-3-114"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cross Validation Results: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-3-115" name="__codelineno-3-115"></a>
<a id="__codelineno-3-116" name="__codelineno-3-116"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="s2">&quot;LDM&quot;</span><span class="p">,</span><span class="s2">&quot;LOG&quot;</span><span class="p">,</span><span class="s2">&quot;PRO&quot;</span><span class="p">,</span><span class="s2">&quot;RF&quot;</span><span class="p">,</span><span class="s2">&quot;SVM&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cv_scores_ldm</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cv_scores_log</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cv_scores_probit</span><span class="p">),</span>
<a id="__codelineno-3-117" name="__codelineno-3-117"></a>            <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cv_scores_rf</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cv_scores_svm</span><span class="p">)],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;forestgreen&quot;</span><span class="p">)</span>
<a id="__codelineno-3-118" name="__codelineno-3-118"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Averages of Cross Validation Scores (Accuracy)&quot;</span><span class="p">)</span>
<a id="__codelineno-3-119" name="__codelineno-3-119"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Models&#39;</span><span class="p">)</span>
<a id="__codelineno-3-120" name="__codelineno-3-120"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Avg. CV Scores&#39;</span><span class="p">)</span>
<a id="__codelineno-3-121" name="__codelineno-3-121"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a id="__codelineno-3-122" name="__codelineno-3-122"></a>
<a id="__codelineno-3-123" name="__codelineno-3-123"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="s2">&quot;LDM&quot;</span><span class="p">,</span><span class="s2">&quot;LOG&quot;</span><span class="p">,</span><span class="s2">&quot;PRO&quot;</span><span class="p">,</span><span class="s2">&quot;RF&quot;</span><span class="p">,</span><span class="s2">&quot;SVM&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">cv_scores_ldm</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">cv_scores_log</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">cv_scores_probit</span><span class="p">),</span>
<a id="__codelineno-3-124" name="__codelineno-3-124"></a>            <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">cv_scores_rf</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">cv_scores_svm</span><span class="p">)],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;forestgreen&quot;</span><span class="p">)</span>
<a id="__codelineno-3-125" name="__codelineno-3-125"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Standard Deviations of Cross Validation Scores (Accuracy)&quot;</span><span class="p">)</span>
<a id="__codelineno-3-126" name="__codelineno-3-126"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Models&#39;</span><span class="p">)</span>
<a id="__codelineno-3-127" name="__codelineno-3-127"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Standard Deviations&#39;</span><span class="p">)</span>
<a id="__codelineno-3-128" name="__codelineno-3-128"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a id="__codelineno-3-129" name="__codelineno-3-129"></a>
<a id="__codelineno-3-130" name="__codelineno-3-130"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">cv_scores</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-3-131" name="__codelineno-3-131"></a>
<a id="__codelineno-3-132" name="__codelineno-3-132"></a>    <span class="c1"># Performance Analysis: Accuracy, Precision, Recall, F1-Score</span>
<a id="__codelineno-3-133" name="__codelineno-3-133"></a>    <span class="n">categories</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Accuracy&quot;</span><span class="p">,</span><span class="s2">&quot;Precision&quot;</span><span class="p">,</span><span class="s2">&quot;Recall&quot;</span><span class="p">,</span><span class="s2">&quot;F1-Score&quot;</span><span class="p">]</span>
<a id="__codelineno-3-134" name="__codelineno-3-134"></a>    <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
<a id="__codelineno-3-135" name="__codelineno-3-135"></a>    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatterpolar</span><span class="p">(</span>
<a id="__codelineno-3-136" name="__codelineno-3-136"></a>      <span class="n">r</span><span class="o">=</span><span class="p">[</span><span class="n">accuracy_ldm</span><span class="p">,</span><span class="n">precision_ldm</span><span class="p">,</span><span class="n">recall_ldm</span><span class="p">,</span><span class="n">f1_score_ldm</span><span class="p">],</span>
<a id="__codelineno-3-137" name="__codelineno-3-137"></a>      <span class="n">theta</span><span class="o">=</span><span class="n">categories</span><span class="p">,</span>
<a id="__codelineno-3-138" name="__codelineno-3-138"></a>      <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;toself&#39;</span><span class="p">,</span>
<a id="__codelineno-3-139" name="__codelineno-3-139"></a>      <span class="n">name</span><span class="o">=</span><span class="s1">&#39;LDM&#39;</span>
<a id="__codelineno-3-140" name="__codelineno-3-140"></a>    <span class="p">))</span>
<a id="__codelineno-3-141" name="__codelineno-3-141"></a>    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatterpolar</span><span class="p">(</span>
<a id="__codelineno-3-142" name="__codelineno-3-142"></a>      <span class="n">r</span><span class="o">=</span><span class="p">[</span><span class="n">accuracy_log</span><span class="p">,</span><span class="n">precision_log</span><span class="p">,</span><span class="n">recall_log</span><span class="p">,</span><span class="n">f1_score_log</span><span class="p">],</span>
<a id="__codelineno-3-143" name="__codelineno-3-143"></a>      <span class="n">theta</span><span class="o">=</span><span class="n">categories</span><span class="p">,</span>
<a id="__codelineno-3-144" name="__codelineno-3-144"></a>      <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;toself&#39;</span><span class="p">,</span>
<a id="__codelineno-3-145" name="__codelineno-3-145"></a>      <span class="n">name</span><span class="o">=</span><span class="s1">&#39;LOG&#39;</span>
<a id="__codelineno-3-146" name="__codelineno-3-146"></a>    <span class="p">))</span>
<a id="__codelineno-3-147" name="__codelineno-3-147"></a>    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatterpolar</span><span class="p">(</span>
<a id="__codelineno-3-148" name="__codelineno-3-148"></a>      <span class="n">r</span><span class="o">=</span><span class="p">[</span><span class="n">accuracy_probit</span><span class="p">,</span><span class="n">precision_probit</span><span class="p">,</span><span class="n">recall_probit</span><span class="p">,</span><span class="n">f1_score_probit</span><span class="p">],</span>
<a id="__codelineno-3-149" name="__codelineno-3-149"></a>      <span class="n">theta</span><span class="o">=</span><span class="n">categories</span><span class="p">,</span>
<a id="__codelineno-3-150" name="__codelineno-3-150"></a>      <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;toself&#39;</span><span class="p">,</span>
<a id="__codelineno-3-151" name="__codelineno-3-151"></a>      <span class="n">name</span><span class="o">=</span><span class="s1">&#39;PRO&#39;</span>
<a id="__codelineno-3-152" name="__codelineno-3-152"></a>    <span class="p">))</span>
<a id="__codelineno-3-153" name="__codelineno-3-153"></a>    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatterpolar</span><span class="p">(</span>
<a id="__codelineno-3-154" name="__codelineno-3-154"></a>      <span class="n">r</span><span class="o">=</span><span class="p">[</span><span class="n">accuracy_rf</span><span class="p">,</span><span class="n">precision_rf</span><span class="p">,</span><span class="n">recall_rf</span><span class="p">,</span><span class="n">f1_score_rf</span><span class="p">],</span>
<a id="__codelineno-3-155" name="__codelineno-3-155"></a>      <span class="n">theta</span><span class="o">=</span><span class="n">categories</span><span class="p">,</span>
<a id="__codelineno-3-156" name="__codelineno-3-156"></a>      <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;toself&#39;</span><span class="p">,</span>
<a id="__codelineno-3-157" name="__codelineno-3-157"></a>      <span class="n">name</span><span class="o">=</span><span class="s1">&#39;RF&#39;</span>
<a id="__codelineno-3-158" name="__codelineno-3-158"></a>    <span class="p">))</span>
<a id="__codelineno-3-159" name="__codelineno-3-159"></a>    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatterpolar</span><span class="p">(</span>
<a id="__codelineno-3-160" name="__codelineno-3-160"></a>      <span class="n">r</span><span class="o">=</span><span class="p">[</span><span class="n">accuracy_svm</span><span class="p">,</span><span class="n">precision_svm</span><span class="p">,</span><span class="n">recall_svm</span><span class="p">,</span><span class="n">f1_score_svm</span><span class="p">],</span>
<a id="__codelineno-3-161" name="__codelineno-3-161"></a>      <span class="n">theta</span><span class="o">=</span><span class="n">categories</span><span class="p">,</span>
<a id="__codelineno-3-162" name="__codelineno-3-162"></a>      <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;toself&#39;</span><span class="p">,</span>
<a id="__codelineno-3-163" name="__codelineno-3-163"></a>      <span class="n">name</span><span class="o">=</span><span class="s1">&#39;SVM&#39;</span>
<a id="__codelineno-3-164" name="__codelineno-3-164"></a>    <span class="p">))</span>
<a id="__codelineno-3-165" name="__codelineno-3-165"></a>    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
<a id="__codelineno-3-166" name="__codelineno-3-166"></a>      <span class="n">polar</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-3-167" name="__codelineno-3-167"></a>        <span class="n">radialaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-3-168" name="__codelineno-3-168"></a>          <span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-3-169" name="__codelineno-3-169"></a>          <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-3-170" name="__codelineno-3-170"></a>        <span class="p">)),</span>
<a id="__codelineno-3-171" name="__codelineno-3-171"></a>      <span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-3-172" name="__codelineno-3-172"></a>    <span class="p">)</span>
<a id="__codelineno-3-173" name="__codelineno-3-173"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Model Performance Analysis: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-3-174" name="__codelineno-3-174"></a>    <span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a id="__codelineno-3-175" name="__codelineno-3-175"></a>    <span class="n">model_perf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Accuracy&quot;</span><span class="p">:[</span><span class="n">accuracy_ldm</span><span class="p">,</span><span class="n">accuracy_log</span><span class="p">,</span><span class="n">accuracy_probit</span><span class="p">,</span><span class="n">accuracy_rf</span><span class="p">,</span><span class="n">accuracy_svm</span><span class="p">],</span>
<a id="__codelineno-3-176" name="__codelineno-3-176"></a>                               <span class="s2">&quot;Precision&quot;</span><span class="p">:[</span><span class="n">precision_ldm</span><span class="p">,</span><span class="n">precision_log</span><span class="p">,</span><span class="n">precision_probit</span><span class="p">,</span><span class="n">precision_rf</span><span class="p">,</span><span class="n">precision_svm</span><span class="p">],</span>
<a id="__codelineno-3-177" name="__codelineno-3-177"></a>                               <span class="s2">&quot;Recall&quot;</span><span class="p">:[</span><span class="n">recall_ldm</span><span class="p">,</span><span class="n">recall_log</span><span class="p">,</span><span class="n">recall_probit</span><span class="p">,</span><span class="n">recall_rf</span><span class="p">,</span><span class="n">recall_svm</span><span class="p">],</span>
<a id="__codelineno-3-178" name="__codelineno-3-178"></a>                               <span class="s2">&quot;F1-Score&quot;</span><span class="p">:[</span><span class="n">f1_score_ldm</span><span class="p">,</span><span class="n">f1_score_log</span><span class="p">,</span><span class="n">f1_score_probit</span><span class="p">,</span><span class="n">f1_score_rf</span><span class="p">,</span><span class="n">f1_score_svm</span><span class="p">]})</span>
<a id="__codelineno-3-179" name="__codelineno-3-179"></a>    <span class="n">model_perf</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;LDM&quot;</span><span class="p">,</span><span class="s2">&quot;LOG&quot;</span><span class="p">,</span><span class="s2">&quot;PRO&quot;</span><span class="p">,</span><span class="s2">&quot;RF&quot;</span><span class="p">,</span><span class="s2">&quot;SVM&quot;</span><span class="p">]</span>
<a id="__codelineno-3-180" name="__codelineno-3-180"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">model_perf</span><span class="p">)</span> 
<a id="__codelineno-3-181" name="__codelineno-3-181"></a>
<a id="__codelineno-3-182" name="__codelineno-3-182"></a>    <span class="k">return</span> 
<a id="__codelineno-3-183" name="__codelineno-3-183"></a>
<a id="__codelineno-3-184" name="__codelineno-3-184"></a><span class="n">ModelPerformance</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;target&quot;</span><span class="p">)</span>  
<a id="__codelineno-3-185" name="__codelineno-3-185"></a><span class="nb">print</span><span class="p">(</span><span class="n">ModelPerformance</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h2 id="result">Result<a class="headerlink" href="#result" title="Permanent link">&para;</a></h2>
<p>As a result, we find that, for our exercise, the SVM model was the best one to perform in the test split. Not so ever, in the training set we notice a slightly better approach with the Random Forest, it depicted a better accuracy in average and a lower standard deviation.</p>
<p>Thus, because we want to study the impact of our model in predicting the possibility of having a cancer diagnosis, we determine that the best model in this case is the SVM. Because, even though it was not the best performer in the training sample, it perform similar to the other models in terms of the average accuracy across folds and depicted a low variance.</p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2024 <a href="https://github.com/96947300/JEM207-Project.git" target="_blank" rel="noopener"> Nicolas Escudero Rivera and Çağlar Aydın</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/96947300/JEM207-Project.git" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.sections", "toc.integrate", "navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.cide.copy"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.8fd75fb4.min.js"></script>
      
    
  </body>
</html>